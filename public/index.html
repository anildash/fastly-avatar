<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Make Your Fastly Avatar!</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- OpenGraph/Social sharing -->
    <meta name="description" content="My meta description." />
    <meta name="og:description" content="My meta description." />
    <meta
      property="og:image"
      content="https://cdn.glitch.com/560ed5ed-9d00-433a-9ff9-7750d79d13da%2FGlitch_TeamAvatar.png?v&#x3D;1624643105812"
    />
    <meta property="og:title" content="Fastly Avatar!" />
    <meta name="twitter:card" content="summary" />
    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <link
      href="https://fonts.googleapis.com/css?family=Inter:regular,italic,extrabold"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto+Mono"
      rel="stylesheet"
      type="text/css"
    />
    <!--PWA requirements-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link
      rel="apple-touch-icon"
      href="https://cdn.glitch.me/efc5414a-882b-4708-af81-8461abbc1a82%2Ftouch-icon.png?v=1633521972305"
    />

    <!-- PWA setup - update public/sw.js if you add your own assets like a new .css file -->
    <link rel="manifest" href="manifest.json" />
    <script>
      if (location.protocol == "http:") location.protocol = "https:";
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("sw.js")
          .then((reg) => console.log("Service Worker registered", reg))
          .catch((err) =>
            console.error("Service Worker **not** registered", err)
          );
      } else {
        console.warn("Service Worker not supported in this browser");
      }
    </script>
    <!--- THEMES: in settings.json change 'glitch' to 'gallery', 'menu', or any other theme in the layout/themes folder --->
    <link rel="stylesheet" type="text/css" href="/themes/fastly.css" />
  </head>
  <body>
    <main>
      <div class="wrapper">
        <div class="content">
          <!-- Avatar Image -->
          <div class="avatar-container">
            <img
              src="https://cdn.glitch.global/a9b09f01-4e09-4e41-b034-9ee762850753/tachometer-red-SVG.svg?v=1681790330400"
              class="avatar"
              alt="Fastly Avatar"
            />
          </div>
          <h1>Make Your Fastly Avatar!</h1>
          <p>
            Pick your favorite headshot of yourself (square image, please!), then choose a style of logo to overlay on your picture. Click "Gimme my avatar!" and your image will automatically download, ready to use.
          </p>
          <p>
            <strong>Tip:</strong> You can make more than one! Maybe you want to show off your Fastly 
          </p>

          <form action="/upload" method="post" enctype="multipart/form-data">
            <input type="file" id="image-upload" name="file" accept="image/*" />
            <label for="image-upload">Upload a square profile image</label>

            <div class="custom-select">

            <select id="overlay" class="overlay" name="overlay">
              <option value="blank">Choose a style:</option>
              <option value="big-tach-dark">Big Fastly Logo</option>
              <option value="glitch-dark">Glitch</option>
              <option value="nyc-cloud">NYC Cloud</option>
              <option value="nyc-dark">NYC Dark</option>
              <option value="nyc-red">NYC Red</option>
              <option value="nyc-violet">NYC Violet</option>
              <option value="nyc-wine">NYC Wine</option>
              <option value="tach-overlay-black">Tach Black (Right)</option>
              <option value="tach-overlay-black-left">Tach Black (Left)</option>
              <option value="tach-overlay-white">Tach White (Right)</option>
              <option value="tach-overlay-white-left">Tach White (Left)</option>
              <option value="tach-overlay-red">Tach Red (Right)</option>
              <option value="tach-overlay-red-left">Tach Red (Left)</option>
            </select>

            </div>

            <button type="submit" id="submit-button">Gimme my avatar!</button>          </form>
        </div>
      </div>

      <div class="content"></div>

      <!--- FOOTER: You can safely remove the Glitch footer (but tell your friends!) âœ‚ --->
      <footer class="footer">
        <div class="tagline">
          <b>Your Fastly Avatar!</b><br />
          Your picture, upgraded.
        </div>
        <a
          class="btn--remix"
          target="_top"
          href="https://glitch.com/edit/#!/remix/fastly-avatar"
        >
          <img
            src="https://cdn.glitch.com/605e2a51-d45f-4d87-a285-9410ad350515%2FLogo_Color.svg?v=1618199565140"
            alt=""
          />
          Make your own avatar app
        </a>
      </footer>
    </main>
    
    <script>
      var x, i, j, l, ll, selElmnt, a, b, c;
      /* Look for any elements with the class "custom-select": */
      x = document.getElementsByClassName("custom-select");
      l = x.length;
      for (i = 0; i < l; i++) {
        selElmnt = x[i].getElementsByTagName("select")[0];
        ll = selElmnt.length;
        /* For each element, create a new DIV that will act as the selected item: */
        a = document.createElement("DIV");
        a.setAttribute("class", "select-selected select-item");
        /* a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML + '<img src="https://fastly-avatar.glitch.me/overlays/' + selElmnt.options[selElmnt.selectedIndex].value + '.png">'; */
        a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
        a.style.backgroundImage = 'url("https://fastly-avatar.glitch.me/overlays/' + selElmnt.options[selElmnt.selectedIndex].value + '.png")';

        x[i].appendChild(a);
        /* For each element, create a new DIV that will contain the option list: */
        b = document.createElement("DIV");
        b.setAttribute("class", "select-items select-hide");
        for (j = 1; j < ll; j++) {
          /* For each option in the original select element,
          create a new DIV that will act as an option item: */
          c = document.createElement("DIV");
          c.setAttribute("class", "select-item");
          /* c.innerHTML = selElmnt.options[j].innerHTML + '<img src="https://fastly-avatar.glitch.me/overlays/' + selElmnt.options[j].value + '.png">'; */
          c.innerHTML = selElmnt.options[j].innerHTML;
          c.style.backgroundImage = 'url("https://fastly-avatar.glitch.me/overlays/' + selElmnt.options[j].value + '.png")';
          c.addEventListener("click", function(e) {
              /* When an item is clicked, update the original select box,
              and the selected item: */
              var y, i, k, s, h, sl, yl;
              s = this.parentNode.parentNode.getElementsByTagName("select")[0];
              sl = s.length;
              console.log(this.parentNode.previousSibling)
              h = this.parentNode.previousSibling;
              for (i = 0; i < sl; i++) {
                if (s.options[i].innerHTML == this.innerHTML) {
                  s.selectedIndex = i;
                  h.innerHTML = this.innerHTML;
                  y = this.parentNode.getElementsByClassName("same-as-selected");
                  yl = y.length;
                  for (k = 0; k < yl; k++) {
                    y[k].removeAttribute("class");
                  }
                  this.setAttribute("class", "same-as-selected");
                  break;
                }
              }
              h.click();
          });
          b.appendChild(c);
        }
        x[i].appendChild(b);
        a.addEventListener("click", function(e) {
          /* When the select box is clicked, close any other select boxes,
          and open/close the current select box: */
          e.stopPropagation();
          closeAllSelect(this);
          this.nextSibling.classList.toggle("select-hide");
          this.classList.toggle("select-arrow-active");
        });
      }

      function closeAllSelect(elmnt) {
        /* A function that will close all select boxes in the document,
        except the current select box: */
        var x, y, i, xl, yl, arrNo = [];
        x = document.getElementsByClassName("select-items");
        y = document.getElementsByClassName("select-selected");
        xl = x.length;
        yl = y.length;
        for (i = 0; i < yl; i++) {
          if (elmnt == y[i]) {
            arrNo.push(i)
          } else {
            y[i].classList.remove("select-arrow-active");
          }
        }
        for (i = 0; i < xl; i++) {
          if (arrNo.indexOf(i)) {
            x[i].classList.add("select-hide");
          }
        }
      }

      /* If the user clicks anywhere outside the select box,
      then close all select boxes: */
      document.addEventListener("click", closeAllSelect);
    </script>
  </body>
</html>
